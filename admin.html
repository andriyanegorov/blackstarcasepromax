<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BR Admin Ultimate</title>
    <style>
        body { background: #121212; color: #eee; font-family: monospace; padding: 20px; margin: 0; }
        h2, h3 { color: #FFD700; margin-top: 0; }
        .container { display: grid; grid-template-columns: 250px 1fr; gap: 20px; }
        .sidebar { background: #1e1e1e; padding: 15px; border: 1px solid #333; height: fit-content; }
        .editor { background: #1e1e1e; padding: 15px; border: 1px solid #333; }
        
        button { cursor: pointer; padding: 8px; border: none; font-weight: bold; width: 100%; margin-bottom: 5px; }
        .btn-green { background: #4CAF50; color: white; }
        .btn-red { background: #ff4d4d; color: white; }
        .btn-gold { background: #FFD700; color: black; }
        .btn-blue { background: #2196F3; color: white; }
        .btn-item { background: #333; color: white; text-align: left; border-bottom: 1px solid #444; }
        .btn-item:hover { background: #444; }
        .btn-item.active { background: #7C4DFF; }

        input, select { width: 100%; padding: 8px; margin-bottom: 10px; background: #222; border: 1px solid #555; color: white; box-sizing: border-box; }
        label { display: block; font-size: 12px; color: #aaa; margin-bottom: 3px; }
        
        .item-row { display: grid; grid-template-columns: 50px 2fr 1fr 2fr 50px; gap: 10px; align-items: center; background: #252525; padding: 5px; margin-bottom: 5px; border-left: 5px solid #555; }
        .promo-row { display: grid; grid-template-columns: 2fr 1fr 2fr 50px; gap: 10px; align-items: center; background: #252525; padding: 10px; margin-bottom: 5px; border-left: 5px solid #FFD700; }
        
        .item-img-preview { width: 40px; height: 30px; object-fit: contain; background: #000; }
        .export-area { width: 100%; height: 150px; background: #000; color: #0f0; border: 1px solid #333; font-size: 11px; margin-top: 10px; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { background: #333; border: 1px solid #555; color: #aaa; flex: 1; padding: 10px; text-align: center; cursor: pointer; }
        .tab-btn.active { background: #FFD700; color: black; border-color: #FFD700; font-weight: bold; }
        
        /* –¶–≤–µ—Ç–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏ */
        .border-consumer { border-left-color: #B0B0B0; }
        .border-common { border-left-color: #4CAF50; }
        .border-rare { border-left-color: #2196F3; }
        .border-epic { border-left-color: #9C27B0; }
        .border-legendary { border-left-color: #FFD700; }
    </style>
</head>
<body>

    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2>‚öôÔ∏è ADMIN PANEL</h2>
        <button onclick="exportConfig()" class="btn-gold" style="width: auto; padding: 10px 30px;">–°–ö–û–ü–ò–†–û–í–ê–¢–¨ CONFIG.JS</button>
    </div>

    <div class="tabs">
        <div class="tab-btn active" onclick="setMode('cases')" id="tab-cases">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö–µ–π—Å–∞–º–∏</div>
        <div class="tab-btn" onclick="setMode('promos')" id="tab-promos">üéü –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü—Ä–æ–º–æ–∫–æ–¥–∞–º–∏</div>
    </div>

    <div class="container" id="view-cases">
        <div class="sidebar">
            <h3>–°–ø–∏—Å–æ–∫ –ö–µ–π—Å–æ–≤</h3>
            <div id="cases-list"></div>
            <button class="btn-green" onclick="addNewCase()">+ –ù–æ–≤—ã–π –ö–µ–π—Å</button>
        </div>

        <div class="editor" id="editor-area" style="display:none;">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–µ–π—Å–∞</h3>
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞:</label>
            <input type="text" id="case-name" oninput="updateCaseMeta()">
            <label>–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ):</label>
            <input type="number" id="case-price" oninput="updateCaseMeta()">
            <label>–ö–∞—Ä—Ç–∏–Ω–∫–∞ (URL):</label>
            <input type="text" id="case-img" oninput="updateCaseMeta()">
            <img id="case-img-preview" src="" style="height: 60px; display: block; margin-bottom: 15px;">

            <div style="border-top: 1px solid #444; padding-top: 10px; margin-top: 10px;">
                <div style="display:flex; justify-content:space-between;">
                    <h3>–ü—Ä–µ–¥–º–µ—Ç—ã</h3>
                    <button class="btn-green" style="width:auto;" onclick="addItem()">+ –ü—Ä–µ–¥–º–µ—Ç</button>
                </div>
                <div id="items-container"></div>
            </div>
            <button class="btn-red" style="margin-top: 20px;" onclick="deleteCurrentCase()">–£–¥–∞–ª–∏—Ç—å –ö–µ–π—Å</button>
        </div>
    </div>

    <div class="container" id="view-promos" style="display:none; grid-template-columns: 1fr;">
        <div class="editor">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3>–°–ø–∏—Å–æ–∫ –ü—Ä–æ–º–æ–∫–æ–¥–æ–≤</h3>
                <button class="btn-blue" style="width:auto; padding: 10px 20px;" onclick="addPromo()">+ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–¥</button>
            </div>
            <div style="margin-top: 15px;">
                <div style="display:grid; grid-template-columns: 2fr 1fr 2fr 50px; gap:10px; font-size:12px; color:#888; margin-bottom:5px; padding:0 10px;">
                    <span>–ö–æ–¥ (–ü—Ä–∏–º–µ—Ä: ADMIN)</span>
                    <span>–°—É–º–º–∞ (‚ÇΩ)</span>
                    <span>–¢–∏–ø (–†–∞–∑–æ–≤—ã–π/–í–µ—á–Ω—ã–π)</span>
                    <span>Del</span>
                </div>
                <div id="promos-container"></div>
            </div>
        </div>
    </div>

    <div style="margin-top: 30px;">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç (–í—Å—Ç–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ script.js):</h3>
        <textarea id="output-json" class="export-area" readonly></textarea>
    </div>

    <script>
        // === –î–ê–ù–ù–´–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ ===
        let gameData = [
            {
                "id": 1,
                "name": "–ë–æ–º–∂ –°—Ç–∞—Ä—Ç",
                "price": 29,
                "img": "https://i.imgur.com/9EkONxH.png",
                "items": [
                    { "name": "50.000 –í–∏—Ä—Ç", "price": 20, "img": "https://i.imgur.com/iQ3Ff5L.png", "rarity": "consumer" },
                    { "name": "1.000.000 –í–∏—Ä—Ç", "price": 500, "img": "https://i.imgur.com/iQ3Ff5L.png", "rarity": "legendary" }
                ]
            }
        ];

        let promoData = [
            { "code": "ADMINKAADMINKAADMINKA", "val": 1000, "limit": 0 }
        ];

        let currentCaseIdx = -1;

        // –ó–∞–≥—Ä—É–∑–∫–∞
        const savedCases = localStorage.getItem('admin_game_config_v2');
        if(savedCases) gameData = JSON.parse(savedCases);

        const savedPromos = localStorage.getItem('admin_promo_config_v1');
        if(savedPromos) promoData = JSON.parse(savedPromos);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        renderCasesList();
        renderPromos();
        exportConfig(); 

        // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –í–ö–õ–ê–î–ö–ê–ú–ò ===
        function setMode(mode) {
            document.getElementById('view-cases').style.display = mode === 'cases' ? 'grid' : 'none';
            document.getElementById('view-promos').style.display = mode === 'promos' ? 'grid' : 'none';
            
            document.getElementById('tab-cases').className = `tab-btn ${mode==='cases'?'active':''}`;
            document.getElementById('tab-promos').className = `tab-btn ${mode==='promos'?'active':''}`;
        }

        // === –õ–û–ì–ò–ö–ê –ö–ï–ô–°–û–í ===
        function renderCasesList() {
            const list = document.getElementById('cases-list');
            list.innerHTML = '';
            gameData.forEach((c, idx) => {
                const btn = document.createElement('button');
                btn.className = `btn-item ${idx === currentCaseIdx ? 'active' : ''}`;
                btn.innerText = c.name;
                btn.onclick = () => selectCase(idx);
                list.appendChild(btn);
            });
        }

        function selectCase(idx) {
            currentCaseIdx = idx;
            renderCasesList();
            const c = gameData[idx];
            
            document.getElementById('editor-area').style.display = 'block';
            document.getElementById('case-name').value = c.name;
            document.getElementById('case-price').value = c.price;
            document.getElementById('case-img').value = c.img;
            document.getElementById('case-img-preview').src = c.img;
            
            renderItems(c.items);
        }

        function renderItems(items) {
            const container = document.getElementById('items-container');
            container.innerHTML = '';
            
            items.forEach((item, idx) => {
                const row = document.createElement('div');
                row.className = `item-row border-${item.rarity}`;
                row.innerHTML = `
                    <img src="${item.img}" class="item-img-preview">
                    <input type="text" value="${item.name}" onchange="updateItem(${idx}, 'name', this.value)">
                    <input type="number" value="${item.price}" onchange="updateItem(${idx}, 'price', this.value)">
                    <select onchange="updateItem(${idx}, 'rarity', this.value)">
                        <option value="consumer" ${item.rarity==='consumer'?'selected':''}>–®–∏—Ä–ø–æ—Ç—Ä–µ–±</option>
                        <option value="common" ${item.rarity==='common'?'selected':''}>–û–±—ã—á–Ω—ã–π</option>
                        <option value="rare" ${item.rarity==='rare'?'selected':''}>–†–µ–¥–∫–∏–π</option>
                        <option value="epic" ${item.rarity==='epic'?'selected':''}>–≠–ø–∏—á–µ—Å–∫–∏–π</option>
                        <option value="legendary" ${item.rarity==='legendary'?'selected':''}>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</option>
                    </select>
                    <button class="btn-red" style="width:30px; padding:5px;" onclick="deleteItem(${idx})">x</button>
                    <input type="text" value="${item.img}" placeholder="URL" style="grid-column: 1 / -1; font-size:10px; color:#aaa;" onchange="updateItem(${idx}, 'img', this.value)">
                `;
                container.appendChild(row);
            });
        }

        function updateCaseMeta() {
            if(currentCaseIdx === -1) return;
            gameData[currentCaseIdx].name = document.getElementById('case-name').value;
            gameData[currentCaseIdx].price = parseInt(document.getElementById('case-price').value) || 0;
            gameData[currentCaseIdx].img = document.getElementById('case-img').value;
            document.getElementById('case-img-preview').src = gameData[currentCaseIdx].img;
            renderCasesList();
            save();
        }

        function updateItem(itemIdx, field, value) {
            if(field === 'price') value = parseInt(value) || 0;
            gameData[currentCaseIdx].items[itemIdx][field] = value;
            renderItems(gameData[currentCaseIdx].items);
            save();
        }

        function addItem() {
            if(currentCaseIdx === -1) return;
            gameData[currentCaseIdx].items.push({ name: "–ù–æ–≤—ã–π", price: 100, img: "", rarity: "consumer" });
            renderItems(gameData[currentCaseIdx].items);
            save();
        }

        function deleteItem(idx) {
            if(!confirm("–£–¥–∞–ª–∏—Ç—å?")) return;
            gameData[currentCaseIdx].items.splice(idx, 1);
            renderItems(gameData[currentCaseIdx].items);
            save();
        }

        function addNewCase() {
            gameData.push({ id: Date.now(), name: "New Case", price: 1000, img: "", items: [] });
            selectCase(gameData.length - 1);
            save();
        }

        function deleteCurrentCase() {
            if(!confirm("–£–¥–∞–ª–∏—Ç—å –∫–µ–π—Å?")) return;
            gameData.splice(currentCaseIdx, 1);
            currentCaseIdx = -1;
            document.getElementById('editor-area').style.display = 'none';
            renderCasesList();
            save();
        }

        // === –õ–û–ì–ò–ö–ê –ü–†–û–ú–û–ö–û–î–û–í ===
        function renderPromos() {
            const container = document.getElementById('promos-container');
            container.innerHTML = '';

            promoData.forEach((promo, idx) => {
                const row = document.createElement('div');
                row.className = 'promo-row';
                row.innerHTML = `
                    <input type="text" value="${promo.code}" placeholder="CODE" onchange="updatePromo(${idx}, 'code', this.value)" style="margin:0; font-weight:bold; color:gold;">
                    <input type="number" value="${promo.val}" placeholder="–°—É–º–º–∞" onchange="updatePromo(${idx}, 'val', this.value)" style="margin:0;">
                    <select onchange="updatePromo(${idx}, 'limit', this.value)" style="margin:0;">
                        <option value="1" ${promo.limit == 1 ? 'selected' : ''}>1 —Ä–∞–∑ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç</option>
                        <option value="0" ${promo.limit == 0 ? 'selected' : ''}>–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ</option>
                    </select>
                    <button class="btn-red" style="width:30px; margin:0;" onclick="deletePromo(${idx})">x</button>
                `;
                container.appendChild(row);
            });
        }

        function addPromo() {
            promoData.push({ code: "NEWCODE", val: 100, limit: 1 });
            renderPromos();
            save();
        }

        function deletePromo(idx) {
            if(!confirm("–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥?")) return;
            promoData.splice(idx, 1);
            renderPromos();
            save();
        }

        function updatePromo(idx, field, val) {
            if(field === 'val' || field === 'limit') val = parseInt(val);
            promoData[idx][field] = val;
            save(); // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        }

        // === –û–ë–©–ï–ï ===
        function save() {
            localStorage.setItem('admin_game_config_v2', JSON.stringify(gameData));
            localStorage.setItem('admin_promo_config_v1', JSON.stringify(promoData));
            exportConfig();
        }

        function exportConfig() {
            const jsonCases = JSON.stringify(gameData, null, 4);
            const jsonPromos = JSON.stringify(promoData, null, 4);
            
            const str = `const GAME_CONFIG = ${jsonCases};\n\nconst PROMO_CODES = ${jsonPromos};`;
            
            document.getElementById('output-json').value = str;
        }
    </script>
</body>
</html>