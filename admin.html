<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Local Storage</title>
    <style>
        body { background: #121212; color: white; font-family: monospace; padding: 20px; }
        input, button { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; background: #222; border: 1px solid #444; color: white; }
        button { background: #FFD700; color: black; font-weight: bold; cursor: pointer; border: none; }
        button:hover { opacity: 0.9; }
        .card { background: #1e1e1e; padding: 15px; margin-bottom: 20px; border: 1px solid #333; }
        h3 { border-bottom: 1px solid #444; padding-bottom: 5px; color: #FFD700; }
        .user-row { display: flex; justify-content: space-between; padding: 10px; background: #111; margin-bottom: 5px; border-left: 3px solid #FFD700; }
    </style>
</head>
<body>

    <h2>ADMIN CONTROL (Local)</h2>
    <p style="color: #666; font-size: 12px;">Эта панель видит данные только в текущем браузере.</p>

    <div class="card">
        <h3>Игрок на этом устройстве</h3>
        <div id="users-list"></div>
    </div>
    
    <div class="card">
        <h3>Редактор Баланса</h3>
        <input type="number" id="target-amount" placeholder="Сумма (+ или -)">
        <button onclick="modifyBalance()">Изменить баланс</button>
        <button onclick="resetUser()" style="background: red; color: white; margin-top: 10px;">Сбросить данные игрока</button>
    </div>

    <script>
        // Ключ такой же, как в script.js
        const DB_KEY = 'br_user_data';

        document.addEventListener('DOMContentLoaded', loadUser);

        function loadUser() {
            const list = document.getElementById('users-list');
            list.innerHTML = '';
            
            const saved = localStorage.getItem(DB_KEY);
            if(saved) {
                const u = JSON.parse(saved);
                list.innerHTML = `
                    <div class="user-row">
                        <div>
                            <div style="font-weight:bold">${u.name || 'Гость'}</div>
                            <div style="font-size:12px; color:#888;">UID: ${u.uid}</div>
                        </div>
                        <span style="color: gold; font-size: 18px;">${u.balance} ₽</span>
                    </div>
                    <div style="font-size: 12px; margin-top: 5px;">Инвентарь: ${u.inventory.length} шт.</div>
                `;
            } else {
                list.innerHTML = "Данных нет. Зайдите в index.html хотя бы раз.";
            }
        }

        function modifyBalance() {
            const amount = parseInt(document.getElementById('target-amount').value);
            if(isNaN(amount)) return;

            const saved = localStorage.getItem(DB_KEY);
            if(saved) {
                const u = JSON.parse(saved);
                u.balance += amount;
                localStorage.setItem(DB_KEY, JSON.stringify(u));
                alert(`Баланс изменен. Теперь: ${u.balance}`);
                loadUser();
            }
        }

        function resetUser() {
            if(confirm("Удалить весь прогресс?")) {
                localStorage.removeItem(DB_KEY);
                alert("Сброшено!");
                loadUser();
            }
        }
    </script>
</body>
</html>